<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dockerfile Cheatsheet To√†n Di·ªán</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f4f7f6;
            color: #333;
        }
        .container {
            max-width: 1000px;
            margin: auto;
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #0db7ed;
            border-bottom: 2px solid #0db7ed;
            padding-bottom: 10px;
            text-align: center;
        }
        h2 {
            color: #0d83ed;
            margin-top: 25px;
            border-left: 5px solid #0d83ed;
            padding-left: 10px;
            background-color: #eaf6ff;
            padding: 8px;
            border-radius: 4px;
        }
        code {
            background-color: #f0f0f0;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: Consolas, monospace;
            color: #c7254e;
        }
        pre {
            background-color: #272822;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            margin-top: 10px;
        }
        .command-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .command-table th, .command-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
            vertical-align: top;
        }
        .command-table th {
            background-color: #0db7ed;
            color: white;
            width: 20%;
        }
        .best-practice {
            background-color: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 15px;
            margin-top: 20px;
            border-radius: 4px;
        }
        .best-practice strong {
            color: #856404;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>üê≥ Dockerfile Cheatsheet To√†n Di·ªán</h1>
    
    <div class="best-practice">
        <strong>Quy T·∫Øc V√†ng:</strong> C√°c l·ªánh **RUN**, **COPY**, **ADD** t·∫°o ra m·ªôt **Layer** m·ªõi. ∆Øu ti√™n n·ªëi l·ªánh **RUN** b·∫±ng `&&` ƒë·ªÉ gi·∫£m k√≠ch th∆∞·ªõc Image.
    </div>

    <h2>1. C·∫•u H√¨nh N·ªÅn T·∫£ng (Base Configuration)</h2>
    <table class="command-table">
        <thead>
            <tr>
                <th>L·ªánh</th>
                <th>C√∫ ph√°p/V√≠ d·ª•</th>
                <th>M√¥ t·∫£ & T∆∞∆°ng t·ª±</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><code>FROM</code></td>
                <td><code>FROM python:3.10-slim</code></td>
                <td>Ch·ªâ ƒë·ªãnh **Image C∆° s·ªü** (Base Image). Ph·∫£i l√† l·ªánh ƒë·∫ßu ti√™n.</td>
            </tr>
            <tr>
                <td><code>WORKDIR</code></td>
                <td><code>WORKDIR /app</code></td>
                <td>Thi·∫øt l·∫≠p th∆∞ m·ª•c l√†m vi·ªác m·∫∑c ƒë·ªãnh cho c√°c l·ªánh ti·∫øp theo (gi·ªëng nh∆∞ `cd`).</td>
            </tr>
            <tr>
                <td><code>ENV</code></td>
                <td><code>ENV PORT=8080</code></td>
                <td>Thi·∫øt l·∫≠p **Bi·∫øn M√¥i Tr∆∞·ªùng** vƒ©nh vi·ªÖn trong Image. (S·ª≠ d·ª•ng `$PORT` trong c√°c l·ªánh sau).</td>
            </tr>
            <tr>
                <td><code>EXPOSE</code></td>
                <td><code>EXPOSE 80 443</code></td>
                <td>Th√¥ng b√°o c·ªïng m·∫°ng m√† container s·∫Ω l·∫Øng nghe (Ch·ªâ l√† t√†i li·ªáu, kh√¥ng t·ª± m·ªü c·ªïng).</td>
            </tr>
        </tbody>
    </table>

    <h2>2. L·ªánh Build & Truy·ªÅn File (Build & File Operations)</h2>
    <table class="command-table">
        <thead>
            <tr>
                <th>L·ªánh</th>
                <th>C√∫ ph√°p & S·ª± Kh√°c Bi·ªát</th>
                <th>M·ª•c ƒê√≠ch & Best Practice</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><code>COPY</code></td>
                <td><code>COPY . /app</code><br><code>COPY requirements.txt .</code></td>
                <td>
                    Sao ch√©p file t·ª´ **Context Build** (m√°y Host) v√†o Image.
                    <ul>
                        <li><strong>Ngu·ªìn (`.`):</strong> Lu√¥n l√† th∆∞ m·ª•c Context.</li>
                        <li><strong>ƒê√≠ch (`/app`):</strong> Lu√¥n l√† ƒë∆∞·ªùng d·∫´n trong Container.</li>
                        <li>**M·∫πo:** ƒê·∫∑t l·ªánh n√†y ·ªü cu·ªëi ƒë·ªÉ t·∫≠n d·ª•ng Caching.</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td><code>RUN</code></td>
                <td><code>RUN conda env create -f env.yml</code></td>
                <td>
                    Th·ª±c thi l·ªánh **trong qu√° tr√¨nh build Image**.
                    <ul>
                        <li>M·ªói l·ªánh <code>RUN</code> t·∫°o ra m·ªôt **Layer** m·ªõi.</li>
                        <li>D√πng ƒë·ªÉ **c√†i ƒë·∫∑t** ph·∫ßn m·ªÅm, th∆∞ vi·ªán (<code>pip install</code>).</li>
                    </ul>
                </td>
            </tr>
        </tbody>
    </table>

    <div class="best-practice">
        <strong>T·ªëi ∆∞u H√≥a RUN:</strong> N·ªëi l·ªánh b·∫±ng `&&` ƒë·ªÉ t·∫°o ch·ªâ **m·ªôt Layer** v√† gi·∫£m k√≠ch th∆∞·ªõc Image.
        <pre>
RUN apt-get update \
    && apt-get install -y git \
    && rm -rf /var/lib/apt/lists/*</pre>
    </div>

    <h2>3. L·ªánh Kh·ªüi ƒê·ªông (Entrypoint & Command)</h2>
    <table class="command-table">
        <thead>
            <tr>
                <th>L·ªánh</th>
                <th>C√∫ ph√°p (Exec Form)</th>
                <th>Th·ªùi ƒëi·ªÉm Ch·∫°y</th>
                <th>Kh·∫£ nƒÉng Ghi ƒë√®</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><code>CMD</code></td>
                <td><code>CMD ["python", "app.py"]</code></td>
                <td>Khi ch·∫°y <code>docker run</code> (Runtime)</td>
                <td>**D·ªÖ d√†ng** b·ªã ghi ƒë√® b·∫±ng l·ªánh m·ªõi.</td>
            </tr>
            <tr>
                <td><code>ENTRYPOINT</code></td>
                <td><code>ENTRYPOINT ["/bin/bash"]</code></td>
                <td>Khi ch·∫°y <code>docker run</code> (Runtime)</td>
                <td>**Kh√≥ b·ªã ghi ƒë√®** (Ch·ªâ ghi ƒë√® b·∫±ng <code>--entrypoint</code>).</td>
            </tr>
        </tbody>
    </table>

    <div class="best-practice">
        <strong>S·ª≠ d·ª•ng K·∫øt H·ª£p:</strong> D√πng <code>ENTRYPOINT</code> ƒë·ªÉ thi·∫øt l·∫≠p l·ªánh ch√≠nh c·ªë ƒë·ªãnh, v√† <code>CMD</code> ƒë·ªÉ cung c·∫•p c√°c tham s·ªë m·∫∑c ƒë·ªãnh.
        <pre>
ENTRYPOINT ["/bin/bash", "-c"] 
CMD ["echo 'Hello World'"]
# L·ªánh th·ª±c thi: /bin/bash -c "echo 'Hello World'"</pre>
    </div>

    <h2>4. Ph√¢n Bi·ªát ƒê∆∞·ªùng D·∫´n (K√Ω T·ª±)</h2>
    <table class="command-table">
        <thead>
            <tr>
                <th>K√Ω T·ª±</th>
                <th>√ù Nghƒ©a V·ªã tr√≠ Ngu·ªìn (Host)</th>
                <th>√ù Nghƒ©a V·ªã tr√≠ ƒê√≠ch (Container)</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><code>.</code></td>
                <td>Th∆∞ m·ª•c Context Build (M√°y Host c·ªßa b·∫°n)</td>
                <td>Th∆∞ m·ª•c L√†m vi·ªác Hi·ªán t·∫°i (CWD - ƒê√£ ƒë∆∞·ª£c ƒë·∫∑t b·ªüi <code>WORKDIR</code>)</td>
            </tr>
            <tr>
                <td><code>/</code></td>
                <td>Kh√¥ng √°p d·ª•ng</td>
                <td>Th∆∞ m·ª•c **G·ªëc (Root)** c·ªßa h·ªá th·ªëng Linux trong Container.</td>
            </tr>
            <tr>
                <td><code>COPY . /app</code></td>
                <td colspan="2">Sao ch√©p **T·∫§T C·∫¢** t·ª´ th∆∞ m·ª•c Host hi·ªán t·∫°i v√†o th∆∞ m·ª•c `/app` trong Container.</td>
            </tr>
        </tbody>
    </table>
</div>

</body>
</html>